package com.webforj.component.optiondialog;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNull;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.spy;
import static org.mockito.Mockito.when;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

class DwcFileOpenTest {

  DwcFileOpen<?> component;
  FileChooserFilter mockFilter1;
  FileChooserFilter mockFilter2;

  @BeforeEach
  void setUp() {
    component = spy(new DwcFileOpen<>());
    mockFilter1 = mock(FileChooserFilter.class);
    mockFilter2 = mock(FileChooserFilter.class);
  }

  @Test
  void shouldSetTitle() {
    String title = "Test Title";
    component.setTitle(title);
    assertEquals(title, component.getTitle());
  }

  @Test
  void shouldSetAndGetFilters() {
    List<FileChooserFilter> filters = Arrays.asList(mockFilter1, mockFilter2);
    component.setFilters(filters);
    assertEquals(filters, component.getFilters());

    component.setFilters(null);
    assertEquals(Collections.emptyList(), component.getFilters());
  }

  @Test
  void shouldAddFilter() {
    component.setFilters(new ArrayList<>());
    component.addFilter(mockFilter1);
    assertTrue(component.getFilters().contains(mockFilter1));
  }

  @Test
  void shouldAddFilterWithDescriptionAndPattern() {
    String description = "Description";
    String pattern = "Pattern";
    component.setFilters(new ArrayList<>());
    component.addFilter(description, pattern);
    assertEquals(description, component.getFilters().get(0).getDescription());
    assertEquals(pattern, component.getFilters().get(0).getPattern());
  }

  @Test
  void shouldRemoveFilter() {
    List<FileChooserFilter> filters = new ArrayList<>(Arrays.asList(mockFilter1, mockFilter2));
    component.setFilters(filters);
    component.removeFilter(mockFilter1);
    assertFalse(component.getFilters().contains(mockFilter1));
    assertTrue(component.getFilters().contains(mockFilter2));
  }

  @Test
  void shouldRemoveFilterByName() {
    when(mockFilter1.getDescription()).thenReturn("Filter1");
    when(mockFilter2.getDescription()).thenReturn("Filter2");

    List<FileChooserFilter> filters = new ArrayList<>(Arrays.asList(mockFilter1, mockFilter2));
    component.setFilters(filters);
    component.removeFilter("Filter1");
    assertFalse(component.getFilters().contains(mockFilter1));
    assertTrue(component.getFilters().contains(mockFilter2));
  }

  @Test
  void shouldSetActiveFilter() {
    component.setActiveFilter(mockFilter1);
    assertEquals(mockFilter1, component.getActiveFilter());
  }

  @Test
  void shouldSetActiveFilterByName() {
    when(mockFilter1.getDescription()).thenReturn("Filter1");
    when(mockFilter2.getDescription()).thenReturn("Filter2");

    List<FileChooserFilter> filters = new ArrayList<>(Arrays.asList(mockFilter1, mockFilter2));
    component.setFilters(filters);
    component.setActiveFilter("Filter1");
    assertEquals(mockFilter1, component.getActiveFilter());

    component.setActiveFilter("NonExistentFilter");
    assertNull(component.getActiveFilter());
  }
}
